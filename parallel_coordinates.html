<html>
<head>
    <link rel="stylesheet" type="text/css" href="style/d3.parcoords.css">
    <link rel="stylesheet" type="text/css" href="style/style.css">
    <script type="text/javascript" src="d3/d3.js"></script>
    <script type="text/javascript" src="d3/d3.parcoords.js"></script>
    <script>
        // linear color scale
        var blue_to_brown = d3.scale.linear()
                .domain([9, 50])
                .range(["steelblue", "brown"])
                .interpolate(d3.interpolateLab);

        // interact with this variable from a javascript console
        var pc1;

        var file = "wine_white.csv";
        // load csv file and create the chart
        var dsv = d3.dsv(";", "text/plain");
        dsv(file, function (data) {
            console.dir(data);
            data.forEach(function(d,i){
                d.name="wine"+i;
            });
//        d3.csv('cars.csv', function (data) {
            pc1 = d3.parcoords()("#example1")
                    .data(data)
                    .hideAxis(["name"])
                    .composite("darker")
                    .color(function (d) {
                        return blue_to_brown(d['economy (mpg)']);
                    })  // quantitative color scale
                    .alpha(0.35)
                    .render()
//                    .reorderable()
                    .brushMode("1D-axes")  // enable brushing
                    .interactive()  // command line mode
;
            var explore_count = 0;
            var exploring = {};
            var explore_start = false;
            pc1.svg
                    .selectAll(".dimension")
                    .style("cursor", "pointer")
                    .on("click", function (d) {
                        exploring[d] = !(d in exploring);
                        event.preventDefault();
                        if (exploring[d]) d3.timer(explore(d, explore_count));
                    });

            function explore(dimension, count) {
                if (!explore_start) {
                    explore_start = true;
                    d3.timer(pc1.brush);
                }
                var speed = (Math.round(Math.random()) ? 1 : -1) * (Math.random() + 0.5);
                return function (t) {
                    if (!exploring[dimension]) return true;
                    var domain = pc1.yscale[dimension].domain();
                    var width = (domain[1] - domain[0]) / 4;

                    var center = width * 1.5 * (1 + Math.sin(speed * t / 1200)) + domain[0];

                    pc1.yscale[dimension].brush.extent([
                        d3.max([center - width * 0.01, domain[0] - width / 400]),
                        d3.min([center + width * 1.01, domain[1] + width / 100])
                    ])(pc1.g()
                            .filter(function (d) {
                                return d == dimension;
                            })
                    );
                };
            }

        });
    </script>
</head>
<body>
<div id="example1" class="parcoords"></div>

</body>
</html>
