<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>What makes good taste of wine?</title>
    <style>
        div.bar {
            display: inline-block;
            width: 20px;
            height: 75px; /* We'll override height later */
            background-color: teal;
            margin-right: 2px;
        }

        div.container {
            display: inline-block;
            width: 320px;
            height: 575px;
            background-color: #e0e0e0;
            margin: 5px;
        }
    </style>
    <script type="text/javascript" src="d3/d3.js"></script>
</head>
<body>
<script type="text/javascript">
    var width;
    var height;

    var dataset;
    var file = "wine_sample.csv";
    var linearScale = d3.scale.linear().domain([0, 10]).range([0, 200]);

    var data_keys = [];
    var dsv = d3.dsv(";", "text/plain");
    dsv(file, function (data) {
        dataset = data;    //Once loaded, copy to dataset.
        if (dataset.length > 0) {
            for (var prop in dataset[0]) {
                data_keys.push(prop);
            }
            generateVis();     //Then call other functions that
            //hideLoadingMsg();  //depend on data being present.
        }
    });
    function breakObjectIntoArray(datum) {
        var data_array = [];
        data_keys.forEach(function (prop) {
            data_array.push({data_key: prop, data_value: datum[prop]});
        });
        return data_array;
    }
    function generateVis() {
        d3.select("body").append("div").attr("id", "wrapper");

        var container = d3.select("#wrapper").selectAll("div")
                .data(dataset)
                .enter().append("div").attr("class", "container");

        var p = container.selectAll("p").data(function (d) {
            return breakObjectIntoArray(d);
        }).enter().append("p").text(function (d) {
            return d.data_key + ":" + d.data_value;
        });


//        var color = d3.scale.category20();
//
//        var svg = d3.select("body").append("svg")
//                .attr("width", width)
//                .attr("height", height)
//                .append("g")
//                .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");
//
//        svg.selectAll("path")
//                .data(pie(data))
//                .enter().append("path")
//                .style("fill", function (d, i) {
//                    return color(i);
//                })
//                .attr("d", arc);

        d3.selectAll(".container").sort(function (a, b) {
            return b["quality"] - a["quality"]
        });
    }
</script>
</body>
</html>
